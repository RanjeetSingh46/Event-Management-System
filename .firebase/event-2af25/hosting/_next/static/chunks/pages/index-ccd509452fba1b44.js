(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(3098)}])},4499:function(e,t,s){"use strict";s.r(t);var r=s(5893),i=s(7294),a=s(4e3),n=s(7747),l=s(2757),c=s(2177),o=s(109),d=s(2305),u=s(5454),h=s(4206),x=s(2154),j=s(4283),m=s(6910),p=s(3447),f=s(5592),g=s(1065);t.default=()=>{let[e,t]=(0,i.useState)([]),[s,v]=(0,i.useState)({total:0,active:0}),[b,y]=(0,i.useState)([]),[S,w]=(0,i.useState)(!0),[E,C]=(0,i.useState)(null);return((0,i.useEffect)(()=>{(async()=>{try{let e=(0,o.hJ)(g.db,"events"),s=(await (0,o.PL)(e)).docs.reduce((e,t)=>{let{category:s}=t.data();return e[s]=(e[s]||0)+1,e},{});t(Object.entries(s).map(e=>{let[t,s]=e;return{name:t,value:s}}));let r=(0,o.hJ)(g.db,"users"),i=(await (0,o.PL)(r)).size,a=await (0,o.PL)((0,o.IO)(r,(0,o.ar)("lastActive",">=",new Date(Date.now()-2592e6))));v({total:i,active:a.size});let n=(0,o.IO)(e,(0,o.Xo)("attendees","desc"),(0,o.b9)(5)),l=await (0,o.PL)(n);y(l.docs.map(e=>({id:e.id,...e.data()})))}catch(e){C("Failed to fetch analytics data."),console.error("Error fetching analytics:",e)}finally{w(!1)}})()},[]),S)?(0,r.jsx)(a.x,{children:"Loading analytics..."}):E?(0,r.jsx)(a.x,{color:"red.500",children:E}):(0,r.jsxs)(n.xu,{p:5,children:[(0,r.jsx)(l.X,{mb:5,children:"Analytics Dashboard"}),(0,r.jsxs)(c.M,{columns:2,spacing:10,children:[(0,r.jsxs)(n.xu,{children:[(0,r.jsx)(l.X,{size:"md",mb:3,children:"Event Categories"}),(0,r.jsx)(d.h,{width:"100%",height:300,children:(0,r.jsxs)(u.v,{data:e,children:[(0,r.jsx)(h.q,{strokeDasharray:"3 3"}),(0,r.jsx)(x.K,{dataKey:"name"}),(0,r.jsx)(j.B,{}),(0,r.jsx)(m.u,{}),(0,r.jsx)(p.D,{}),(0,r.jsx)(f.$,{dataKey:"value",fill:"#8884d8"})]})})]}),(0,r.jsxs)(n.xu,{children:[(0,r.jsx)(l.X,{size:"md",mb:3,children:"User Statistics"}),(0,r.jsxs)(a.x,{children:["Total Users: ",s.total]}),(0,r.jsxs)(a.x,{children:["Active Users (last 30 days): ",s.active]})]})]}),(0,r.jsxs)(n.xu,{mt:10,children:[(0,r.jsx)(l.X,{size:"md",mb:3,children:"Top 5 Events"}),b.map((e,t)=>(0,r.jsxs)(a.x,{children:[t+1,". ",e.title," - ",e.attendees.length," attendees"]},e.id))]})]})}},3098:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return W}});var r=s(5893),i=s(7747),a=s(3560),n=s(2757),l=s(3349),c=s(1065),o=s(7294),d=s(109);let u=()=>{let[e,t]=(0,o.useState)([]);return(0,o.useEffect)(()=>{let e=(0,d.IO)((0,d.hJ)(c.db,"events"),(0,d.Xo)("date")),s=(0,d.cf)(e,e=>{t(e.docs.map(e=>({id:e.id,...e.data()})))},e=>{console.error("Error fetching events: ",e)});return()=>s()},[]),e};var h=s(5697),x=s.n(h),j=s(5970),m=s(5418),p=s(3090),f=s(5432),g=s(6554),v=s(6914),b=(0,g.G)(function(e,t){let{children:s,placeholder:i,className:a,...n}=e;return(0,r.jsxs)(v.m.select,{...n,ref:t,className:(0,f.cx)("chakra-select",a),children:[i&&(0,r.jsx)("option",{value:"",children:i}),s]})});b.displayName="SelectField";var y=s(8912),S=s(7030),w=s(3179),E=(0,g.G)((e,t)=>{var s;let i=(0,S.jC)("Select",e),{rootProps:a,placeholder:n,icon:l,color:c,height:o,h:d,minH:u,minHeight:h,iconColor:x,iconSize:j,...m}=(0,w.Lr)(e),[p,g]=function(e,t){let s={},r={};for(let[i,a]of Object.entries(e))t.includes(i)?s[i]=a:r[i]=a;return[s,r]}(m,w.oE),E=(0,y.Y)(g),C={paddingEnd:"2rem",...i.field,_focus:{zIndex:"unset",...null==(s=i.field)?void 0:s._focus}};return(0,r.jsxs)(v.m.div,{className:"chakra-select__wrapper",__css:{width:"100%",height:"fit-content",position:"relative",color:c},...p,...a,children:[(0,r.jsx)(b,{ref:t,height:null!=d?d:o,minH:null!=u?u:h,placeholder:n,...E,__css:C,children:e.children}),(0,r.jsx)(_,{"data-disabled":(0,f.PB)(E.disabled),...(x||c)&&{color:x||c},__css:i.icon,...j&&{fontSize:j},children:l})]})});E.displayName="Select";var C=e=>(0,r.jsx)("svg",{viewBox:"0 0 24 24",...e,children:(0,r.jsx)("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})}),I=(0,v.m)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),_=e=>{let{children:t=(0,r.jsx)(C,{}),...s}=e,i=(0,o.cloneElement)(t,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return(0,r.jsx)(I,{...s,className:"chakra-select__icon-wrapper",children:(0,o.isValidElement)(t)?i:null})};_.displayName="SelectIcon";var N=s(4225);let k=e=>{let{onSearch:t}=e,[s,n]=(0,o.useState)(""),[l,c]=(0,o.useState)("all");return(0,r.jsx)(i.xu,{children:(0,r.jsxs)(a.g,{spacing:4,children:[(0,r.jsxs)(j.NI,{children:[(0,r.jsx)(m.l,{htmlFor:"search",children:"Search Events"}),(0,r.jsx)(p.I,{id:"search",placeholder:"Search events...",value:s,onChange:e=>n(e.target.value)})]}),(0,r.jsxs)(j.NI,{children:[(0,r.jsx)(m.l,{htmlFor:"dateRange",children:"Date Range"}),(0,r.jsxs)(E,{id:"dateRange",value:l,onChange:e=>c(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Dates"}),(0,r.jsx)("option",{value:"today",children:"Today"}),(0,r.jsx)("option",{value:"week",children:"This Week"}),(0,r.jsx)("option",{value:"month",children:"This Month"})]})]}),(0,r.jsx)(N.z,{onClick:()=>{t({searchTerm:s,dateRange:l}),n(""),c("all")},colorScheme:"blue",children:"Search"})]})})};k.propTypes={onSearch:x().func.isRequired};var D=s(7963),z=["h","minH","height","minHeight"],L=(0,g.G)((e,t)=>{let s=(0,S.mq)("Textarea",e),{className:i,rows:a,...n}=(0,w.Lr)(e),l=(0,y.Y)(n),c=a?function(e,t=[]){let s=Object.assign({},e);for(let e of t)e in s&&delete s[e];return s}(s,z):s;return(0,r.jsx)(v.m.textarea,{ref:t,rows:a,...l,className:(0,f.cx)("chakra-textarea",i),__css:c})});L.displayName="Textarea";var R=s(1136),T=()=>{let[e,t]=(0,o.useState)({title:"",description:"",date:"",location:""}),[s,l]=(0,o.useState)(!1),u=(0,D.p)(),h=e=>{let{name:s,value:r}=e.target;t(e=>({...e,[s]:r}))},x=async s=>{if(s.preventDefault(),!e.title||!e.description||!e.date||!e.location){u({title:"Error",description:"Please fill in all the fields.",status:"error",duration:5e3,isClosable:!0});return}l(!0);try{let s=c.I.currentUser;if(!s)throw Error("User not authenticated");let r=await (0,d.ET)((0,d.hJ)(c.db,"events"),{...e,createdAt:new Date,createdBy:s.uid,attendees:[s.uid]});await (0,d.r7)((0,d.JU)(c.db,"users",s.uid),{events:(0,d.vr)(r.id)}),t({title:"",description:"",date:"",location:""}),u({title:"Event created",description:"Your event has been successfully created.",status:"success",duration:5e3,isClosable:!0})}catch(e){console.error("Error adding event: ",e),u({title:"Error",description:"There was an error creating your event.",status:"error",duration:5e3,isClosable:!0})}finally{l(!1)}};return(0,r.jsxs)(i.xu,{as:"form",onSubmit:x,children:[(0,r.jsx)(n.X,{className:"mt-4 mb-6",size:"lg",children:"Event Form"}),(0,r.jsxs)(a.g,{spacing:4,children:[(0,r.jsxs)(j.NI,{isRequired:!0,children:[(0,r.jsx)(m.l,{children:"Title"}),(0,r.jsx)(p.I,{name:"title",value:e.title,onChange:h,placeholder:"Enter event title"})]}),(0,r.jsxs)(j.NI,{isRequired:!0,children:[(0,r.jsx)(m.l,{children:"Description"}),(0,r.jsx)(L,{name:"description",value:e.description,onChange:h,placeholder:"Enter event description"})]}),(0,r.jsxs)(j.NI,{isRequired:!0,children:[(0,r.jsx)(m.l,{children:"Date"}),(0,r.jsx)(p.I,{name:"date",type:"datetime-local",value:e.date,onChange:h})]}),(0,r.jsxs)(j.NI,{isRequired:!0,children:[(0,r.jsx)(m.l,{children:"Location"}),(0,r.jsx)(p.I,{name:"location",value:e.location,onChange:h,placeholder:"Enter event location"})]}),(0,r.jsx)(N.z,{onClick:x,colorScheme:"blue",isLoading:s,isDisabled:s||!e.title||!e.description||!e.date||!e.location,children:s?(0,r.jsx)(R.$,{size:"sm"}):"Create Event"})]})]})},P=s(7239),O=s(4e3),X=(0,g.G)(function(e,t){let s=(0,S.mq)("Link",e),{className:i,isExternal:a,...n}=(0,w.Lr)(e);return(0,r.jsx)(v.m.a,{target:a?"_blank":void 0,rel:a?"noopener":void 0,ref:t,className:(0,f.cx)("chakra-link",i),...n,__css:s})});X.displayName="Link";var F=(0,g.G)(function(e,t){let{direction:s,align:i,justify:a,wrap:n,basis:l,grow:c,shrink:o,...d}=e;return(0,r.jsx)(v.m.div,{ref:t,__css:{display:"flex",flexDirection:s,alignItems:i,justifyContent:a,flexWrap:n,flexBasis:l,flexGrow:c,flexShrink:o},...d})});F.displayName="Flex";var J=()=>{let[e,t]=(0,o.useState)([]),[s,l]=(0,o.useState)(1),[u,h]=(0,o.useState)(!0),[x,j]=(0,o.useState)(null);if((0,o.useEffect)(()=>{(async()=>{try{h(!0);let e=(0,d.IO)((0,d.hJ)(c.db,"events"),(0,d.Xo)("date")),s=await (0,d.PL)(e);t(s.docs.map(e=>({id:e.id,...e.data()})))}catch(e){j("Failed to fetch events"),console.error(e)}finally{h(!1)}})()},[]),u)return(0,r.jsx)(P.M,{height:"100vh",children:(0,r.jsx)(R.$,{size:"xl"})});if(x)return(0,r.jsx)(P.M,{height:"100vh",children:(0,r.jsx)(O.x,{color:"red.500",children:x})});let m=10*s,p=e.slice(m-10,m),f=e=>l(e);return(0,r.jsxs)(a.g,{spacing:4,align:"stretch",children:[(0,r.jsx)(n.X,{size:"lg",children:"Upcoming Events"}),0===e.length&&(0,r.jsx)(O.x,{children:"No Events available."}),p.map(e=>(0,r.jsxs)(i.xu,{p:4,borderWidth:1,borderRadius:"md",children:[(0,r.jsx)(n.X,{size:"md",children:e.title}),(0,r.jsx)(O.x,{children:e.description}),(0,r.jsxs)(O.x,{children:["Date: ",new Date(1e3*e.date.seconds).toLocaleString()]}),(0,r.jsxs)(O.x,{children:["Location: ",e.location]}),(0,r.jsx)(X,{href:"/events/".concat(e.id),passHref:!0,children:(0,r.jsx)(N.z,{as:"a",mt:2,colorScheme:"blue",children:"View Details"})})]},e.id)),(0,r.jsx)(F,{justifyContent:"center",mt:4,children:Array.from({length:Math.ceil(e.length/10)}).map((e,t)=>(0,r.jsx)(N.z,{onClick:()=>f(t+1),mx:1,colorScheme:s===t+1?"blue":"gray",children:t+1},t))})]})},A=()=>{let[e,t]=(0,o.useState)([]),[s,u]=(0,l.F_)(c.I);return(0,o.useEffect)(()=>{let e=async()=>{if(s)try{let e=(0,d.IO)((0,d.hJ)(c.db,"notifications"),(0,d.ar)("userId","==",s.uid),(0,d.Xo)("createdAt","desc"),(0,d.b9)(10)),r=(await (0,d.PL)(e)).docs.map(e=>({id:e.id,...e.data()}));t(r)}catch(e){console.error("Error fetching notifications: ",e)}};!u&&s&&e()},[s,u]),(0,r.jsxs)(a.g,{spacing:4,align:"stretch",children:[(0,r.jsx)(n.X,{size:"md",children:"Notifications"}),0===e.length?(0,r.jsx)(O.x,{children:"No notifications available."}):e.map(e=>{var t;return(0,r.jsxs)(i.xu,{p:2,borderWidth:1,borderRadius:"md",children:[(0,r.jsx)(O.x,{children:e.message}),(0,r.jsx)(O.x,{fontSize:"sm",color:"gray.500",children:(null===(t=e.createdAt)||void 0===t?void 0:t.toDate().toLocaleString())||"Date not available"})]},e.id)})]})},U=s(4499),M=s(5146);let Y=async(e,t,s)=>{try{await (0,d.ET)((0,d.hJ)(c.db,"reminders"),{eventId:e,userId:t,reminderTime:s.toISOString(),sent:!1,createdAt:(0,d.Bt)()})}catch(e){console.error("Error scheduling reminder:",e)}};var q=e=>{let{eventId:t,eventDate:s}=e,[a,n]=(0,o.useState)("30"),[d,u]=(0,l.F_)(c.I),h=(0,D.p)(),x=async e=>{if(e.preventDefault(),u){h({title:"Loading...",description:"Please wait while we check your authentication status.",status:"info",duration:3e3,isClosable:!0});return}if(!d){h({title:"Error",description:"You must be logged in to set a reminder.",status:"error",duration:3e3,isClosable:!0});return}let r=new Date(s);r.setMinutes(r.getMinutes()-parseInt(a,10));try{await Y(t,d.uid,r),h({title:"Reminder set",description:"You will be reminded ".concat(a," minutes before the event."),status:"success",duration:3e3,isClosable:!0}),n("30")}catch(e){console.error("Error setting reminder:",e),h({title:"Error",description:"Failed to set reminder.",status:"error",duration:3e3,isClosable:!0})}};return(0,r.jsxs)(i.xu,{as:"form",onSubmit:x,children:[(0,r.jsxs)(j.NI,{isRequired:!0,children:[(0,r.jsx)(m.l,{children:"Set Reminder"}),(0,r.jsxs)(E,{value:a,onChange:e=>n(e.target.value),children:[(0,r.jsx)("option",{value:"15",children:"15 minutes before"}),(0,r.jsx)("option",{value:"30",children:"30 minutes before"}),(0,r.jsx)("option",{value:"60",children:"1 hour before"}),(0,r.jsx)("option",{value:"1440",children:"1 day before"})]})]}),(0,r.jsx)(N.z,{type:"submit",mt:2,colorScheme:"blue",children:"Set Reminder"})]})},V=e=>{let{eventId:t}=e,[s,d]=(0,o.useState)([]),[u]=(0,l.F_)(c.I),h=(0,D.p)();(0,o.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/attendees/".concat(t)),s=await e.json();s.success?d(s.attendees):h({title:"Error",description:s.message||"Event not found.",status:"error",duration:5e3,isClosable:!0})}catch(e){console.error("Error fetching event attendees:",e),h({title:"Error",description:"There was an error fetching attendees.",status:"error",duration:5e3,isClosable:!0})}};t&&e()},[t,h]);let x=async e=>{if(!u){h({title:"Error",description:"You must be logged in to RSVP.",status:"error",duration:5e3,isClosable:!0});return}let s={userId:u.uid,name:u.displayName||u.email,status:e};try{let r=await fetch("/api/attendees/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),i=await r.json();i.success?(h({title:"RSVP Updated",description:"You are now ".concat("attending"===e?"attending":"not attending"," this event."),status:"success",duration:5e3,isClosable:!0}),d(e=>[...e,s])):h({title:"Error",description:i.message,status:"error",duration:5e3,isClosable:!0})}catch(e){console.error("Error updating RSVP:",e),h({title:"Error",description:"There was an error updating your RSVP.",status:"error",duration:5e3,isClosable:!0})}},j=async()=>{if(!u)return;let e={userId:u.uid};try{let s=await fetch("/api/attendees/".concat(t),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await s.json();r.success?(h({title:"RSVP Cancelled",description:"You have cancelled your attendance.",status:"success",duration:5e3,isClosable:!0}),d(e=>e.filter(e=>e.userId!==u.uid))):h({title:"Error",description:r.message,status:"error",duration:5e3,isClosable:!0})}catch(e){console.error("Error canceling RSVP:",e),h({title:"Error",description:"There was an error canceling your RSVP.",status:"error",duration:5e3,isClosable:!0})}};return(0,r.jsxs)(a.g,{spacing:4,align:"stretch",children:[(0,r.jsx)(n.X,{size:"md",children:"Attendees"}),s.length>0?s.map(e=>(0,r.jsx)(i.xu,{p:2,borderWidth:1,borderRadius:"md",children:(0,r.jsxs)(O.x,{children:[e.name," - ",e.status]})},e.userId)):(0,r.jsx)(O.x,{children:"No attendees yet."}),(0,r.jsx)(N.z,{onClick:()=>x("attending"),colorScheme:"green",children:"Attend"}),(0,r.jsx)(N.z,{onClick:j,colorScheme:"red",children:"Cancel Attendance"})]})};function W(){let[e]=(0,l.F_)(c.I),t=u(),[s,h]=(0,o.useState)([]),x=async e=>{let{searchTerm:t,dateRange:s}=e,r=(0,d.IO)((0,d.hJ)(c.db,"events"));if(t&&(r=(0,d.IO)(r,(0,d.ar)("title",">=",t),(0,d.ar)("title","<=",t+""))),"all"!==s){let e;let t=new Date;switch(s){case"today":e=new Date(t.setHours(23,59,59,999));break;case"week":e=new Date(t.setDate(t.getDate()+7));break;case"month":e=new Date(t.setMonth(t.getMonth()+1))}r=(0,d.IO)(r,(0,d.ar)("date",">=",t),(0,d.ar)("date","<=",e))}h((await (0,d.PL)(r)).docs.map(e=>({id:e.id,...e.data()})))};return(0,r.jsx)(i.xu,{p:8,children:(0,r.jsxs)(a.g,{spacing:8,align:"stretch",children:[(0,r.jsx)(n.X,{children:"Event Management System"}),e&&(0,r.jsx)(A,{userId:e.uid}),(0,r.jsx)(k,{onSearch:x}),(0,r.jsx)(J,{events:s||t}),(0,r.jsx)(T,{}),(0,r.jsx)(M.default,{}),(0,r.jsx)(U.default,{}),(0,r.jsx)(q,{}),(0,r.jsx)(V,{})]})})}},5146:function(e,t,s){"use strict";s.r(t);var r=s(5893),i=s(7294),a=s(3349),n=s(1065),l=s(109),c=s(7963),o=s(7747),d=s(3560),u=s(2757),h=s(4e3),x=s(4225);t.default=()=>{let[e]=(0,a.F_)(n.I),[t,s]=(0,i.useState)(null),[j,m]=(0,i.useState)([]),[p,f]=(0,i.useState)(!0),g=(0,c.p)();(0,i.useEffect)(()=>{(async()=>{if(e)try{let t=(0,l.JU)(n.db,"users",e.uid),r=await (0,l.QT)(t);if(r.exists())s(r.data());else{let r={name:e.displayName||"New User",email:e.email,events:[]};await (0,l.pl)(t,r),s(r)}let i=(0,l.IO)((0,l.hJ)(n.db,"events"),(0,l.ar)("attendees","array-contains",e.uid),(0,l.Xo)("date","desc"),(0,l.b9)(10)),a=await (0,l.PL)(i);m(a.docs.map(e=>({id:e.id,...e.data()})))}catch(e){g({title:"Error fetching data",description:e.message,status:"error",duration:3e3,isClosable:!0})}finally{f(!1)}else f(!1)})()},[e,g]);let v=async()=>{try{await n.I.signOut(),g({title:"Signed out successfully",status:"success",duration:3e3,isClosable:!0})}catch(e){g({title:"Error signing out",description:e.message,status:"error",duration:3e3,isClosable:!0})}};return p?(0,r.jsx)("div",{children:"Loading..."}):e&&t?(0,r.jsx)(o.xu,{children:(0,r.jsxs)(d.g,{spacing:4,align:"stretch",children:[(0,r.jsx)(u.X,{children:"User Profile"}),(0,r.jsxs)(h.x,{children:["Name: ",t.name]}),(0,r.jsxs)(h.x,{children:["Email: ",t.email]}),(0,r.jsx)(x.z,{onClick:v,colorScheme:"red",children:"Sign Out"}),(0,r.jsx)(u.X,{size:"md",mt:6,children:"Your Events"}),j.length>0?j.map(e=>(0,r.jsxs)(o.xu,{p:2,borderWidth:1,borderRadius:"md",children:[(0,r.jsx)(h.x,{fontWeight:"bold",children:e.title}),(0,r.jsx)(h.x,{children:e.description}),(0,r.jsx)(h.x,{fontSize:"sm",color:"gray.500",children:new Date(e.date).toLocaleString()}),(0,r.jsxs)(h.x,{fontSize:"sm",children:["Location: ",e.location]})]},e.id)):(0,r.jsx)(h.x,{children:"No events found."})]})}):(0,r.jsx)("div",{children:"User not found"})}}},function(e){e.O(0,[928,398,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);